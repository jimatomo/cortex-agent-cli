vars:
  default:
    SNOWFLAKE_DATABASE: TEST_DB
    SNOWFLAKE_SCHEMA: QA
  prod:
    SNOWFLAKE_SCHEMA: PUBLIC

deploy:
  database: ${ vars.SNOWFLAKE_DATABASE }
  schema: ${ vars.SNOWFLAKE_SCHEMA }
  grant:
    account_roles:
      - role: ANALYST
        privileges:
          - ALL
    database_roles:
      # - role: ${ vars.SNOWFLAKE_DATABASE }.CORTEX_USER
      #   privileges:
      #     - USAGE
      - role: ${ vars.SNOWFLAKE_DATABASE }.CORTEX_MONITOR
        privileges:
          - MONITOR

eval:
  tests:
    - question: "Show me the data of the largest expense"
      expected_tools:
        - sample_semantic_view
    - question: "How do I use the Snowflake AI_FILTER function?"
      expected_tools:
        - cortex_search

name: MY-SUPPORT-AGENT
comment: Customer support agent
profile:
  display_name: Support Bot
models:
  orchestration: auto
instructions:
  response: |
    You are a helpful customer support agent.
orchestration:
  budget:
    seconds: 300
    tokens: 16000
tools:
  - tool_spec:
      description: |-
        This is a sample semantic view. About income and expense.
      name: sample_semantic_view
      type: cortex_analyst_text_to_sql
  - tool_spec:
      description: This is a sample semantic view. 2nd
      name: sample_semantic_view_2
      type: cortex_analyst_text_to_sql
  - tool_spec:
      description: snowflake docs service
      name: snowflake_docs_service
      type: cortex_search
tool_resources:
  sample_semantic_view:
    semantic_view: ${ vars.SNOWFLAKE_DATABASE }.${ vars.SNOWFLAKE_SCHEMA }.SAMPLE_SM
    execution_environment:
      query_timeout: 60
      type: warehouse
      warehouse: ""
  sample_semantic_view_2:
    execution_environment:
      query_timeout: 60
      type: warehouse
      warehouse: COMPUTE_WH
    semantic_view: ${ vars.SNOWFLAKE_DATABASE }.${ vars.SNOWFLAKE_SCHEMA }.SAMPLE_SM_2
  snowflake_docs_service:
    id_column: SOURCE_URL
    max_results: 4
    search_service: SNOWFLAKE_DOCUMENTATION.SHARED.CKE_SNOWFLAKE_DOCS_SERVICE
    title_column: DOCUMENT_TITLE
